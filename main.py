"""
–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –≥–∏–±—Ä–∏–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
–°–æ—á–µ—Ç–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
"""

import asyncio
import logging
import sys
import signal
from pathlib import Path
from datetime import datetime
import threading

sys.path.insert(0, str(Path(__file__).parent))

from config.settings import LOGGING, WEB_SERVER, ANALYTICS_CONFIG
from core.session_manager import SessionManager
from core.database import DatabaseManager
from core.analytics_engine import AnalyticsEngine
from core.message_processor import MessageProcessor
from web.auth_server import run_auth_server
from web.dashboard_server import run_dashboard_server
from utils.logger import setup_logger

class –ì–∏–±—Ä–∏–¥–Ω–∞—è–°–∏—Å—Ç–µ–º–∞:
    def __init__(self):
        self.–ª–æ–≥–≥–µ—Ä = setup_logger('–≥–∏–±—Ä–∏–¥–Ω–∞—è_—Å–∏—Å—Ç–µ–º–∞')
        self.–º–µ–Ω–µ–¥–∂–µ—Ä_—Å–µ—Å—Å–∏–π = SessionManager()
        self.–±–∞–∑–∞_–¥–∞–Ω–Ω—ã—Ö = DatabaseManager()
        self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏ = AnalyticsEngine()
        self.–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä_—Å–æ–æ–±—â–µ–Ω–∏–π = MessageProcessor()
        self.–∞–∫—Ç–∏–≤–Ω–∞ = False
        self.–Ω–∞–∑–≤–∞–Ω–∏–µ = "Telegram Insights Pro"
        
    async def –∑–∞–ø—É—Å—Ç–∏—Ç—å(self):
        self.–∞–∫—Ç–∏–≤–Ω–∞ = True
        
        self.–ª–æ–≥–≥–µ—Ä.info("‚îÅ" * 60)
        self.–ª–æ–≥–≥–µ—Ä.info(f"{self.–Ω–∞–∑–≤–∞–Ω–∏–µ} - –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ v3.0")
        self.–ª–æ–≥–≥–µ—Ä.info("‚îÅ" * 60)
        self.–ª–æ–≥–≥–µ—Ä.info("üìä –ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: –ê–ö–¢–ò–í–ï–ù")
        self.–ª–æ–≥–≥–µ—Ä.info("üëÅÔ∏è –ú–æ–¥—É–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞: –ê–ö–¢–ò–í–ï–ù")
        self.–ª–æ–≥–≥–µ—Ä.info("üìà –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤: –ê–ö–¢–ò–í–ù–ê")
        self.–ª–æ–≥–≥–µ—Ä.info("üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –í–ö–õ–Æ–ß–ï–ù–ê")
        self.–ª–æ–≥–≥–µ—Ä.info("‚îÅ" * 60)
        
        try:
            # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö
            auth_thread = threading.Thread(
                target=run_auth_server,
                daemon=True,
                name="Auth_Server"
            )
            auth_thread.start()
            
            dashboard_thread = threading.Thread(
                target=run_dashboard_server,
                daemon=True,
                name="Dashboard_Server"
            )
            dashboard_thread.start()
            
            self.–ª–æ–≥–≥–µ—Ä.info(f"–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: –ø–æ—Ä—Ç {WEB_SERVER['auth_port']}")
            self.–ª–æ–≥–≥–µ—Ä.info(f"–î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: –ø–æ—Ä—Ç {WEB_SERVER['dashboard_port']}")
            
            # –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            await self.–∑–∞–≥—Ä—É–∑–∏—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π()
            
            # –ó–∞–ø—É—Å–∫ –¥–≤–∏–∂–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            await self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.–∑–∞–ø—É—Å—Ç–∏—Ç—å()
            
            # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
            while self.–∞–∫—Ç–∏–≤–Ω–∞:
                await asyncio.sleep(10)
                
                # –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
                await self.–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ_–∑–∞–¥–∞—á–∏()
                
        except KeyboardInterrupt:
            self.–ª–æ–≥–≥–µ—Ä.info("–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è")
        except Exception as e:
            self.–ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ —Å–∏—Å—Ç–µ–º—ã: {e}")
        finally:
            await self.–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å()
    
    async def –∑–∞–≥—Ä—É–∑–∏—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        self.–ª–æ–≥–≥–µ—Ä.info("–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π...")
        
        # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î
        # –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        —Ç–µ—Å—Ç–æ–≤—ã–µ_–¥–∞–Ω–Ω—ã–µ = [
            {
                'user_id': 123456789,
                'username': 'test_user',
                'consent_given': True,
                'analytics_enabled': True,
                'monitoring_enabled': True
            }
        ]
        
        for –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å in —Ç–µ—Å—Ç–æ–≤—ã–µ_–¥–∞–Ω–Ω—ã–µ:
            if –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å['consent_given']:
                await self.–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
    
    async def –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(self, –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ"""
        user_id = –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è['user_id']
        
        try:
            # –ó–∞–ø—É—Å–∫ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è['monitoring_enabled']:
                await self.–º–µ–Ω–µ–¥–∂–µ—Ä_—Å–µ—Å—Å–∏–π.start_user_monitoring(user_id)
                self.–ª–æ–≥–≥–µ—Ä.info(f"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
            
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            if –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è['analytics_enabled']:
                await self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.–¥–æ–±–∞–≤–∏—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(user_id)
                self.–ª–æ–≥–≥–µ—Ä.info(f"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
            
        except Exception as e:
            self.–ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}: {e}")
    
    async def –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ_–∑–∞–¥–∞—á–∏(self):
        """–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ —Å–∏—Å—Ç–µ–º—ã"""
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
        if datetime.now().hour == 0:
            await self.—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ_–æ—Ç—á–µ—Ç—ã()
        
        # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        self.–±–∞–∑–∞_–¥–∞–Ω–Ω—ã—Ö.cleanup_expired_data()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        await self.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π()
    
    async def —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ_–æ—Ç—á–µ—Ç—ã(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏"""
        self.–ª–æ–≥–≥–µ—Ä.info("–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤...")
        
        # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –¥–µ–Ω—å
        —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ = await self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.–ø–æ–ª—É—á–∏—Ç—å_–¥–Ω–µ–≤–Ω—É—é_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É()
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç—ã
        for user_id in —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.keys():
            –æ—Ç—á–µ—Ç = await self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.—Å–æ–∑–¥–∞—Ç—å_–æ—Ç—á–µ—Ç(user_id)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á–µ—Ç
            –ø—É—Ç—å_–æ—Ç—á–µ—Ç–∞ = Path(f"data/analytics_reports/{user_id}_{datetime.now().date()}.json")
            with open(–ø—É—Ç—å_–æ—Ç—á–µ—Ç–∞, 'w', encoding='utf-8') as f:
                import json
                json.dump(–æ—Ç—á–µ—Ç, f, ensure_ascii=False, indent=2)
            
            self.–ª–æ–≥–≥–µ—Ä.info(f"–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è {user_id}: {–ø—É—Ç—å_–æ—Ç—á–µ—Ç–∞}")
    
    async def –ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        –∞–∫—Ç–∏–≤–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ = self.–º–µ–Ω–µ–¥–∂–µ—Ä_—Å–µ—Å—Å–∏–π.get_active_users()
        
        for user_id in –∞–∫—Ç–∏–≤–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            –ø–æ—Å–ª–µ–¥–Ω—è—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å = await self.–±–∞–∑–∞_–¥–∞–Ω–Ω—ã—Ö.–ø–æ–ª—É—á–∏—Ç—å_–ø–æ—Å–ª–µ–¥–Ω—é—é_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å(user_id)
            
            –µ—Å–ª–∏ (datetime.now() - –ø–æ—Å–ª–µ–¥–Ω—è—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å) > timedelta(hours=24):
                self.–ª–æ–≥–≥–µ—Ä.warning(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤")
    
    async def –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã"""
        if not self.–∞–∫—Ç–∏–≤–Ω–∞:
            return
            
        self.–∞–∫—Ç–∏–≤–Ω–∞ = False
        self.–ª–æ–≥–≥–µ—Ä.info("–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã...")
        
        # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
        await self.–º–µ–Ω–µ–¥–∂–µ—Ä_—Å–µ—Å—Å–∏–π.cleanup()
        await self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å()
        
        # –°–æ–∑–¥–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
        —Ñ–∏–Ω–∞–ª—å–Ω—ã–π_–æ—Ç—á–µ—Ç = await self.–¥–≤–∏–∂–æ–∫_–∞–Ω–∞–ª–∏—Ç–∏–∫–∏.—Å–æ–∑–¥–∞—Ç—å_—Ñ–∏–Ω–∞–ª—å–Ω—ã–π_–æ—Ç—á–µ—Ç()
        
        self.–ª–æ–≥–≥–µ—Ä.info("‚îÅ" * 60)
        self.–ª–æ–≥–≥–µ—Ä.info("–°–ò–°–¢–ï–ú–ê –û–°–¢–ê–ù–û–í–õ–ï–ù–ê")
        self.–ª–æ–≥–≥–µ—Ä.info("‚îÅ" * 60)
        self.–ª–æ–≥–≥–µ—Ä.info(f"–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {—Ñ–∏–Ω–∞–ª—å–Ω—ã–π_–æ—Ç—á–µ—Ç.get('total_messages', 0)}")
        self.–ª–æ–≥–≥–µ—Ä.info(f"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –æ—Ç—á–µ—Ç–æ–≤: {—Ñ–∏–Ω–∞–ª—å–Ω—ã–π_–æ—Ç—á–µ—Ç.get('reports_generated', 0)}")
        self.–ª–æ–≥–≥–µ—Ä.info(f"–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {—Ñ–∏–Ω–∞–ª—å–Ω—ã–π_–æ—Ç—á–µ—Ç.get('active_users', 0)}")
        self.–ª–æ–≥–≥–µ—Ä.info("‚îÅ" * 60)
    
    def –æ–±—Ä–∞–±–æ—Ç–∫–∞_—Å–∏–≥–Ω–∞–ª–∞(self, –Ω–æ–º–µ—Ä_—Å–∏–≥–Ω–∞–ª–∞, —Ñ—Ä–µ–π–º):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤"""
        —Å–∏–≥–Ω–∞–ª—ã = {
            signal.SIGINT: "SIGINT",
            signal.SIGTERM: "SIGTERM"
        }
        —Å–∏–≥–Ω–∞–ª = —Å–∏–≥–Ω–∞–ª—ã.get(–Ω–æ–º–µ—Ä_—Å–∏–≥–Ω–∞–ª–∞, f"–°–∏–≥–Ω–∞–ª {–Ω–æ–º–µ—Ä_—Å–∏–≥–Ω–∞–ª–∞}")
        self.–ª–æ–≥–≥–µ—Ä.warning(f"–ü–æ–ª—É—á–µ–Ω {—Å–∏–≥–Ω–∞–ª}, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã...")
        asyncio.create_task(self.–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å())

# –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
async def –æ—Å–Ω–æ–≤–Ω–æ–π_—Ü–∏–∫–ª():
    —Å–∏—Å—Ç–µ–º–∞ = –ì–∏–±—Ä–∏–¥–Ω–∞—è–°–∏—Å—Ç–µ–º–∞()
    
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–∏–≥–Ω–∞–ª–æ–≤
    signal.signal(signal.SIGINT, —Å–∏—Å—Ç–µ–º–∞.–æ–±—Ä–∞–±–æ—Ç–∫–∞_—Å–∏–≥–Ω–∞–ª–∞)
    signal.signal(signal.SIGTERM, —Å–∏—Å—Ç–µ–º–∞.–æ–±—Ä–∞–±–æ—Ç–∫–∞_—Å–∏–≥–Ω–∞–ª–∞)
    
    try:
        await —Å–∏—Å—Ç–µ–º–∞.–∑–∞–ø—É—Å—Ç–∏—Ç—å()
    except Exception as e:
        —Å–∏—Å—Ç–µ–º–∞.–ª–æ–≥–≥–µ—Ä.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        sys.exit(1)

if __name__ == '__main__':
    print("\n" + "‚òÜ" * 60)
    print("          TELEGRAM INSIGHTS PRO - –ì–ò–ë–†–ò–î–ù–ê–Ø –°–ò–°–¢–ï–ú–ê")
    print("‚òÜ" * 60)
    print("\n–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:")
    print("‚úÖ –†–µ–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –≤–∞—à–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤")
    print("üìä –î–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—â–µ–Ω–∏—è")
    print("üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
    print("üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö")
    print("üìã –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã")
    
    print("\n" + "‚îÄ" * 60)
    print("–î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è:")
    print("1. –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ Telegram")
    print("2. –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")
    print("3. –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ —Å–æ–æ–±—â–µ–Ω–∏—è–º")
    print("‚îÄ" * 60)
    
    –æ—Ç–≤–µ—Ç = input("\n–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É? (–¥–∞/–ù–ï–¢): ").strip().lower()
    
    if –æ—Ç–≤–µ—Ç != '–¥–∞':
        print("\n–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.")
        sys.exit(0)
    
    # –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    Path("data/analytics_reports").mkdir(parents=True, exist_ok=True)
    Path("data/user_stats").mkdir(parents=True, exist_ok=True)
    Path("logs").mkdir(exist_ok=True)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—É
    asyncio.run(–æ—Å–Ω–æ–≤–Ω–æ–π_—Ü–∏–∫–ª())